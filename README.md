# Jinja2-ExploitMe
[BEW 2.3: Web Security] Clone this repo to begin the SSTI exploit activity.

## Exploits
- Multiply 2 integers - `?exploit={{5*6}}`
- Multiply an int & a str - `?exploit={{7*7|safe}}`
   - Working solution taken from [C3NZ](https://github.com/C3NZ/Jinja2-ExploitMe).
   - Attempted `?exploit={{7*'7'}}` and variations with ordering and double quotes in browser, but browser converted quotes to proper url encoding.
   - Attempted `?exploit={{7*'7'}}` in Postman, but Postman automatically encodes the URL.
   - Attempted `?exploit={{7*\'7\'}}` with curl, which successfully sends the request as I want it, but Jinja then returns an error
- Output hack.txt from the local filesystem -

## Possible Fixes
- I would naively suggest adding braces to some blacklist of characters to avoid, but Sebastian Neef [demonstrates that blacklists don't fix vulnerabilities](https://0day.work/jinja2-template-injection-filter-bypasses/).
- In some cases, likes names or ages, I could only allow alphanumerical characters.
- Find a library that is really good at escaping. Jinja2 has its own code for [escaping](https://jinja.palletsprojects.com/en/2.10.x/templates/#html-escaping).
- Switch to another templating engine or web framework where exploits are harder to come across.
